##Download Data-Set
conda install -c bioconda sra-tools           

prefetch $(<SRR_Acc_List.txt)
echo '/repository/user/main/public/root = "/path/to/download"' > $HOME/.ncbi/user-settings.mkfg
fastq-dump --split-3 --gzip $(</path_to/SRR_Acc_List.txt)

nano get_SRR_data.sh
fastq-dump --split-3 $1
cat SRR_Acc_List.txt | xargs -n 1 bash get_SRR_data.sh
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/"$1"/"$1".sra
fastq-dump --split-3 "$1".sra

mkdir -p ~/workstation/fqData && cd ~/workstation/fqData
wget "https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE138485&format=file"
tar -xvf GSE138485_RAW.tar

##Download Reference genome (GRCh38.p13)
mkdir -p ~/workstation/sample_data && cd ~/workstation/sample_data 
wget ftp://ftp.ensembl.org/pub/release-99/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.toplevel.fa.gz
gunzip Homo_sapiens.GRCh38.dna.toplevel.fa.gz

##Download Annotation file (GRCh38.p13)
cd ~/workstation/sample_data
wget ftp://ftp.ensembl.org/pub/release-99/gtf/homo_sapiens/Homo_sapiens.GRCh38.99.gtf.gz
gunzip Homo_sapiens.GRCh38.99.gtf.gz

##Create conda environment
conda create -y --name ngs2pro python=3.7     #Another code: conda create -n ngs2pro python=3.7 anaconda
conda activate ngs2pro                        #source activate ngs2pro

##Install the software
conda activate ngs2pro 
conda install -c bioconda -y hisat2
conda install -c bioconda fastqc 
conda install -c bioconda multiqc

##Run the FASTQC for each read
mkdir -p ~/workstation/FASTQC_report && cd ~/workstation/FASTQC_report            
sudo apt install fastqc                       #Explore the help of FASTQC >>> fastqc -h > fastqc_rep
for f in ~/workdir/fqData/*.fq.gz;do fastqc -t 1 -f fastq -noextract $f;done





